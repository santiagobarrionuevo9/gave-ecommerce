<!-- src/app/product/product-detail/product-detail.component.html -->
<div class="container py-4" *ngIf="!loading(); else loadingTpl">
  <ng-container *ngIf="!error; else errorTpl">

    <div class="row g-4">
      <!-- Galería simple -->
      <div class="col-12 col-lg-6">
        <img [src]="mainImage()" class="img-fluid rounded shadow-sm mb-3" [alt]="product.name" />

        <div class="d-flex gap-2 flex-wrap">
          <img *ngFor="let img of images; trackBy: trackByImgId"
               [src]="img.url"
               class="rounded border"
               style="width:90px; height:90px; object-fit:cover; cursor:pointer"
               (click)="selectAsMain(img)"
               [alt]="img.altText || product.name">
        </div>
      </div>

      <!-- Info -->
      <div class="col-12 col-lg-6">
        <h3 class="mb-2">{{ product.name }}</h3>
        <div class="text-muted mb-3" *ngIf="product?.shortDesc">{{ product.shortDesc }}</div>

        <div class="h4 fw-semibold mb-1">$ {{ product.price | number:'1.0-0' }}</div>
        <div class="mb-3" [class.text-danger]="product.stock===0" [class.text-success]="product.stock>0">
          Stock: {{ product.stock }}
        </div>

        <button class="btn btn-primary btn-lg mb-3" [disabled]="product.stock===0">
          Agregar al carrito
        </button>

        <div class="mt-3">
          <h6>Descripción</h6>
          <p class="mb-0" style="white-space:pre-line">{{ product.description || '—' }}</p>
        </div>

        <div class="mt-3">
          <small class="text-muted">SKU: {{ product.sku }}</small>
        </div>
      </div>
    </div>

  </ng-container>
</div>

<ng-template #loadingTpl>
  <div class="container py-4">
    <div class="alert alert-info">Cargando producto…</div>
  </div>
</ng-template>

<ng-template #errorTpl>
  <div class="container py-4">
    <div class="alert alert-danger">{{ error }}</div>
    <a routerLink="/catalogo" class="btn btn-outline-secondary mt-2">Volver al catálogo</a>
  </div>
</ng-template>

